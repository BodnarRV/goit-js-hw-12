{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["export function generateGalleryMarkup(images) {\n  return images\n    .map(\n      ({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => `\n        <li class=\"gallery-item\">\n          <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img\n              class=\"gallery-image\"\n              src=\"${webformatURL}\"\n              alt=\"${tags}\"\n            />\n          </a>\n          <div class=\"info\">\n            <div class=\"info__item\">\n              <p class=\"title\">Likes</p>\n              <p class=\"value\">${likes}</p>\n            </div>\n            <div class=\"info__item\">\n              <p class=\"title\">Views</p>\n              <p class=\"value\">${views}</p>\n            </div>\n            <div class=\"info__item\">\n              <p class=\"title\">Comments</p>\n              <p class=\"value\">${comments}</p>\n            </div>\n            <div class=\"info__item\">\n              <p class=\"title\">Downloads</p>\n              <p class=\"value\">${downloads}</p>\n            </div>\n          </div>\n        </li>\n      `\n    ).join(\"\");\n}\n\nexport function startLoader() {\n  const loaderContainer = document.querySelector('.loader__container');\n  loaderContainer.classList.add('active');\n}\n\nexport function stopLoader() {\n  const loaderContainer = document.querySelector('.loader__container');\n  loaderContainer.classList.remove('active');\n}\n","import axios from 'axios';\nimport { startLoader, stopLoader } from './render-functions';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst apiKey = '46012526-8744745123a0ad884cf175c85';\naxios.defaults.baseURL = 'https://pixabay.com/api/';\n\nexport async function searchImages(query, page, callback) {\n  const params = new URLSearchParams({\n    key: apiKey,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n    page: page,\n    per_page: 15\n  });\n\n  startLoader();\n\n  try {\n    const response = await axios.get('', { params });\n    const data = response.data;\n\n    if (data.hits.length === 0) {\n      iziToast.error({\n        title: 'Error',\n        message: 'Sorry, there are no images matching your search query. Please try again.',\n        position: 'topRight',\n      });\n    } else {\n      callback(data.hits, data.totalHits);\n    }\n  } catch (error) {\n    console.error(error);\n    iziToast.error({\n      title: 'Error',\n      message: 'An error occurred while fetching images. Please try again later.',\n      position: 'topRight',\n    });\n  } finally {\n    stopLoader();\n  }\n}\n\nexport async function loadMoreImages(query, page, callback) {\n  const params = new URLSearchParams({\n    key: apiKey,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n    page: page,\n    per_page: 15\n  });\n\n  startLoader();\n\n  try {\n    const response = await axios.get('', { params });\n    const data = response.data;\n\n    if (data.hits.length === 0) {\n      iziToast.error({\n        title: 'Error',\n        message: 'Sorry, there are no images matching your search query. Please try again.',\n        position: 'topRight',\n      });\n      callback([], data.totalHits);\n    } else {\n      callback(data.hits, data.totalHits);\n    }\n  } catch (error) {\n    console.error(error);\n    iziToast.error({\n      title: 'Error',\n      message: 'An error occurred while fetching images. Please try again later.',\n      position: 'topRight',\n    });\n  } finally {\n    stopLoader();\n  }\n}\n","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport iziToast from \"izitoast\";\nimport { searchImages, loadMoreImages } from \"./js/pixabay-api\";\nimport { generateGalleryMarkup } from \"./js/render-functions\";\n\nconst searchInput = document.querySelector('input[type=search]');\nconst searchBtn = document.querySelector('button[type=submit]');\nconst galleryList = document.querySelector('.gallery__list');\nconst loadMoreButton = document.querySelector('.gallery button');\n\nlet lightbox;\nlet page = 1;\nlet totalHits = 0;\nlet loadedHits = 0;\nlet query = '';\n\nsearchBtn.addEventListener(\"click\", event => {\n  event.preventDefault();\n  query = searchInput.value.trim();\n\n  if (query === '') {\n    iziToast.error({\n      title: 'Error',\n      message: 'Fill search input!',\n      position: 'topRight'\n    });\n    return;\n  }\n\n  galleryList.innerHTML = '';\n  page = 1;\n  loadedHits = 0;\n  \n  searchImages(query, page, (images, total) => {\n    totalHits = total;\n    loadedHits += images.length;\n\n    if (images.length === 0) {\n      iziToast.info({\n        title: 'Info',\n        message: 'No images found.',\n        position: 'topRight',\n      });\n      loadMoreButton.style.display = 'none';\n      return;\n    }\n\n    const markup = generateGalleryMarkup(images);\n    galleryList.innerHTML = markup;\n\n    if (lightbox) {\n      lightbox.refresh();\n    } else {\n      lightbox = new SimpleLightbox('.gallery__list a', {\n        captionsData: 'alt',\n        captionDelay: 250,\n      });\n    }\n\n    searchInput.value = '';\n\n    if (loadedHits < totalHits) {\n      loadMoreButton.style.display = 'block';\n    } else {\n      loadMoreButton.style.display = 'none';\n      iziToast.info({\n        title: 'Info',\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n    }\n  });\n});\n\nloadMoreButton.addEventListener(\"click\", event => {\n  event.preventDefault();\n  page += 1;\n\n  loadMoreImages(query, page, (images, total) => { \n    loadedHits += images.length;\n    const markup = generateGalleryMarkup(images);\n    galleryList.insertAdjacentHTML('beforeend', markup);\n\n    lightbox.refresh();\n    smoothScrollToNewImages()\n\n    if (loadedHits >= totalHits) {\n      loadMoreButton.style.display = 'none';\n      iziToast.info({\n        title: 'Info',\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n    }\n  });\n});\n\nfunction smoothScrollToNewImages() {\n  const { height: cardHeight } = galleryList.firstElementChild.getBoundingClientRect();\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}"],"names":["generateGalleryMarkup","images","webformatURL","largeImageURL","tags","likes","views","comments","downloads","startLoader","stopLoader","apiKey","axios","searchImages","query","page","callback","params","data","iziToast","error","loadMoreImages","searchInput","searchBtn","galleryList","loadMoreButton","lightbox","totalHits","loadedHits","event","total","markup","SimpleLightbox","smoothScrollToNewImages","cardHeight"],"mappings":"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"}